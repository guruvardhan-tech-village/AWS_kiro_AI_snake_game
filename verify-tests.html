<!DOCTYPE html>
<html>
<head>
    <title>Verify Tests</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #000; color: #0f0; }
        .pass { color: #0f0; }
        .fail { color: #f00; }
        .info { color: #0ff; }
    </style>
</head>
<body>
    <h1>Test Verification</h1>
    <div id="output"></div>

    <!-- Required DOM elements for script.js -->
    <canvas id="game" width="400" height="400" style="display: none;"></canvas>
    <div id="score" style="display: none;">0</div>
    <button id="aiBtn" style="display: none;">AI</button>
    <button id="manualBtn" style="display: none;">Manual</button>

    <!-- Load all scripts in correct order -->
    <script src="test-framework.js"></script>
    <script src="property-testing.js"></script>
    <script src="test-utils.js"></script>
    <script src="script.js"></script>

    <script>
        const output = document.getElementById('output');
        
        function log(message, className = '') {
            const div = document.createElement('div');
            div.textContent = message;
            div.className = className;
            output.appendChild(div);
            console.log(message);
        }

        // Test 1: Basic framework functionality
        log('=== TEST 1: Framework Functionality ===', 'info');
        
        try {
            expect(true).toBeTruthy();
            log('✅ expect().toBeTruthy() works', 'pass');
        } catch (e) {
            log('❌ expect().toBeTruthy() failed: ' + e.message, 'fail');
        }

        try {
            expect(false).toBeFalsy();
            log('✅ expect().toBeFalsy() works', 'pass');
        } catch (e) {
            log('❌ expect().toBeFalsy() failed: ' + e.message, 'fail');
        }

        // Test 2: Property testing framework
        log('\n=== TEST 2: Property Testing Framework ===', 'info');
        
        try {
            const property = fc.property(
                [fc.position()],
                (pos) => pos.x >= 0 && pos.x < 20 && pos.y >= 0 && pos.y < 20
            );
            fc.assert(property, 10);
            log('✅ Property test with array syntax works', 'pass');
        } catch (e) {
            log('❌ Property test failed: ' + e.message, 'fail');
        }

        // Test 3: Game variable initialization
        log('\n=== TEST 3: Game Variables ===', 'info');
        
        log('aiMode: ' + window.aiMode);
        log('snake length: ' + window.snake.length);
        log('score: ' + window.score);
        log('gameOver: ' + window.gameOver);

        // Test 4: Mode switching
        log('\n=== TEST 4: Mode Switching ===', 'info');
        
        try {
            window.aiMode = false;
            log('Set aiMode to false: ' + window.aiMode);
            
            if (typeof window.setAIMode === 'function') {
                window.setAIMode();
                log('After setAIMode(): ' + window.aiMode);
                
                if (typeof window.setManualMode === 'function') {
                    window.setManualMode();
                    log('After setManualMode(): ' + window.aiMode);
                    
                    if (window.aiMode === false) {
                        log('✅ Mode switching works correctly', 'pass');
                    } else {
                        log('❌ Mode switching failed - aiMode should be false', 'fail');
                    }
                } else {
                    log('❌ setManualMode function not found', 'fail');
                }
            } else {
                log('❌ setAIMode function not found', 'fail');
            }
        } catch (e) {
            log('❌ Mode switching test failed: ' + e.message, 'fail');
        }

        // Test 5: Run a simple unit test
        log('\n=== TEST 5: Simple Unit Test ===', 'info');
        
        describe('Simple Test', () => {
            test('should work', () => {
                expect(1 + 1).toBe(2);
            });
        });

        runTests().then(results => {
            log('\n=== TEST RESULTS ===', 'info');
            log('Total: ' + results.total);
            log('Passed: ' + results.passed);
            log('Failed: ' + results.failed);
            
            if (results.failed > 0) {
                log('\nFailures:', 'fail');
                results.failures.forEach(failure => {
                    log('- ' + failure.description + ': ' + failure.error, 'fail');
                });
            }
        });
    </script>
</body>
</html>